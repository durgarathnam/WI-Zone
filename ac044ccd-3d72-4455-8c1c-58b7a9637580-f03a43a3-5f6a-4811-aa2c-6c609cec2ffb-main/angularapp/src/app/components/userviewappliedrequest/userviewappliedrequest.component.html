<div class="container">
  <h1>Applied WiFi Scheme Requests</h1>
  <hr>
  <div class="search-container">
    <input type="text" id="search" [(ngModel)]="searchSchemeName" (input)="search()" placeholder="Search by Scheme Name..." required>
  </div>  
  <div *ngIf="filteredRequests.length === 0">
    <p>No data found</p>
  </div>

  <div *ngIf="filteredRequests.length > 0" class="card-container">
    <div *ngFor="let request of filteredRequests" class="card">
      <div class="card-content">
        <div class="card-details">
          <h2>{{ request.wifiScheme.schemeName }}</h2>
          <p><strong>Region:</strong> {{ request.wifiScheme.region }}</p>
          <p><strong>Speed:</strong> {{ request.wifiScheme.speed }}</p>
          <p><strong>Data Limit:</strong> {{ request.wifiScheme.dataLimit }}</p>
          <p><strong>Fee:</strong> {{ request.wifiScheme.fee | currency: 'INR'}}</p>
          <p><strong>Availability Status:</strong> {{ request.wifiScheme.availabilityStatus }}</p>
        </div>
        <div class="button-group">
          <button class="show-more-btn" (click)="showMore(request)">Show More</button>
          <button class="delete-btn" (click)="confirmDelete(request.wifiSchemeRequestId)">Delete</button>
          <button class="review-btn" (click)="navigateToAddFeedback(request.wifiScheme.wifiSchemeId)">Write a Review</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Show More Modal -->
  <div class="modal" *ngIf="showModal">
    <div class="modal-content">
      <span class="close" (click)="closeModal()">&times;</span>
      <h2>Request Details</h2>
      <p><strong>Region:</strong> {{ selectedRequest?.wifiScheme.region }}</p>
      <p><strong>Speed:</strong> {{ selectedRequest?.wifiScheme.speed }}</p>
      <p><strong>Data Limit:</strong> {{ selectedRequest?.wifiScheme.dataLimit }}</p>
      <p><strong>Fee:</strong> {{ selectedRequest?.wifiScheme.fee | currency: 'INR' }}</p>
      <p><strong>Request Date:</strong> {{ selectedRequest?.requestDate }}</p>
      <p><strong>Comments:</strong> {{ selectedRequest?.comments }}</p>
      <p><strong>Status:</strong> {{ selectedRequest?.status }}</p>
      <div *ngIf="selectedRequest?.proof">
        <p><strong>Proof:</strong></p>
        <img [src]="selectedRequest?.proof.startsWith('data:') ? selectedRequest.proof : 'data:image/png;base64,' + selectedRequest.proof" alt="Uploaded File" style="max-width: 20%;">
      </div>
    </div>
  </div>
 
  <!-- Delete Confirmation Modal -->
  <div class="modal" *ngIf="showDeleteModal">
    <div class="modal-content-small"> <!-- Use smaller modal content class -->
      <p>Are you sure you want to delete this request?</p>
      <div class="modal-button-group">
        <button class="yes-delete-btn" (click)="deleteRequest()">Yes, Delete</button>
        <button class="cancel-btn" (click)="cancelDelete()">Cancel</button>
      </div>
    </div>
  </div>
</div>

